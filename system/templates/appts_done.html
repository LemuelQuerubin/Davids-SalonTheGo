
{% extends "general/homepage-user.html" %} 
{% load static %}

{% block content %}
{% comment %} <link rel="stylesheet" href="{% static 'css/admin/accounts.css' %}"> {% endcomment %}
<link rel="stylesheet" href="{% static 'css/admin/accountsV2.css' %}">
<script src="{% static 'js/sorttable.js' %}"></script>

    <div class="main"> 
        <link rel="icon" type="image/x-icon" href="/static/images/favicon.ico">
            <div class="main-wrapper">
                <div class="container">
                    <div class="prodtable-container">
                        <!-- DATE RANGE -->
                        <form method="POST">
                        {% csrf_token %}
                        <!-- END OF DATE RANGE -->
                        <div class="labels-container" style="margin-top: 40px;">     
                                <!-- TITLE -->
                                <div class="labels0">
                                    <h2>Completed Appointments</h2><br>
                                </div>
                                {% comment %} <div class="labels2">
                                    <ul>    
                                        <!-- <li class="top-labels">Filter</li> -->
                                        <li class="top-labels">
                                        <div style="float: left;">
                                            {% csrf_token %}
                                            From: <input type="date" class="filter-date-input" name="fromdate" required/>
                                            To: <input type="date" class="filter-date-input" name="todate" required/>
                                                <input type ="submit" class="filter-search" name="button" value="Search"/>
                                        </div>
                                        </li>
                                        <li class="top-labels"><a href="/appointments/createpdf-joftable" class="export-btn">Export Table</a></li>
                                    </ul>
                                </div> {% endcomment %}
                        </div>
                        <table class="products-table">
                            <thead class="products-thead">
                                <tr>
                                    <!-- TABLE HEADER -->
                                    <th scope="col">Date</th>
                                    <th scope="col">Time</th>
                                    <th scope="col">Customer Name</th>
                                    <th scope="col">Service/s</th>
                                    <th scope="col">Stylist</th>
                                    <th scope="col">Total Amount</th>
                                </tr>
                            </thead>
        
                            <tbody class="products-tbody">
                                {% for appointment in appointments %}
                                    {% if appointment.appointmentStatus == 'Successful' %}
                                    <tr>
                                        <td>{{appointment.apptDate|date:'F d, Y'}}</td>
                                        <td>{{ appointment.appt_timeStart|time:'h:i A'}}</td>
                                        <td>
                                        {% if appointment.apptType == 'Online' %}
                                            <p>{{ appointment.customer.customer.first_name }} {{ appointment.customer.customer.last_name }} </p>
                                        {% else %}
                                            <p>{{ appointment.customer_fname }} {{ appointment.customer_lname }} </p>
                                        {% endif %}</td>
                                        <td>
                                        {% for key in appointment.joborderform.servicePrices.keys %}
                                            {{ key }}
                                            {% if not forloop.last %}
                                                <br>
                                            {% endif %}
                                        {% endfor %}    </td>
                                        <td>{{ appointment.joborderform.finalStylist }}</td>
                                        <td>â‚±{{appointment.joborderform.totalPrice }}</td>
                                    </tr>
                                    {% endif %}
                                {% endfor %}
                            </tbody>

                        </table>
                    </div>
        
                    <!-- PAGE NAVIGATION -->
                    <div class="pagination">
                        <span class="step-links">
                            {% if page_prod.has_previous %}
                                <a href="?page=1">&laquo; first</a>
                                <a href="?page={{ page_prod.previous_page_number }}">previous</a>
                            {% endif %}
                            
                            <!-- PAGE INDICATOR -->
                            <span class="current">
                                Page {{ page_prod.number }} of {{ page_prod.paginator.num_pages }}
                            </span>
                    
                            {% if page_prod.has_next %}
                                <a href="?page={{ page_prod.next_page_number }}">next</a>
                                <a href="?page={{ page_prod.paginator.num_pages }}">last &raquo;</a>
                            {% endif %}
                        </span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- BACK TO TOP BUTTON -->
        <button onclick="topFunction()" id="myBtn" title="Go to top">
            <i class="fa-solid fa-arrow-up"></i>
        </button>
        <!-- BACK TO TOP SCRIPT -->
            <script>
                //Get the button
                var mybutton = document.getElementById("myBtn");
                
                // When the user scrolls down 20px from the top of the document, show the button
                window.onscroll = function() {scrollFunction()};
                
                function scrollFunction() {
                if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                    mybutton.style.display = "block";
                } else {
                    mybutton.style.display = "none";
                }
                }
                
                // When the user clicks on the button, scroll to the top of the document
                function topFunction() {
                document.body.scrollTop = 0;
                document.documentElement.scrollTop = 0;
                }
            </script>
{% endblock content %}