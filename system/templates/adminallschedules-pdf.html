{% load static %}
<html>
<head>
    <title>ALL APPOINTMENT SCHEDULES REPORT</title>
    <link href='http://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
</head>
<body>
    <style>       
        table{
            border: 1px solid black;
        }

        th{
            font-weight: 700;
            font-size: 13px;
            height: 45px;   
            background-color:  #092147;
            padding-top: 5px;
            color: white;
        }

        td{
            text-align: center;   
            height: 55px;
            font-size: 12px;
            padding-top: 5px;
            text-decoration:none;
        }

        h1{
            font-size: 20px;
            color: white;
        }

        h2{
            font-size: 20px;
            color: #092147;
        }

        p{
            font-size: 13px;
        }

        ul{
            list-style:none;
        }

    </style>

<!-- COPY FOR LETTERHEAD -->
<div class="main">    
    <table style="border: 1px solid #092147;background-color: #092147; color: white;">
        <thead>
            <tr>
                <!-- DATE, TIME, HEADER WITH ADDRESS -->
                <td style="
                font-size: 20px;
                height: 40px;">                
                    DAVID'S SALON SM GRAND CENTRAL BRANCH
                </td>
            </tr>
            <tr>
                <td style="
                font-size: 12px;
                height: 70px;">
                    5th Level SM City Grand Central, Rizal Avenue Extension <br> East Grace Park, Caloocan, 1403 Metro Manila <br>Cel. (+63) 905 931 6531 / (+63) 995 664 2394
                </td>
                <!-- END OF DATE, TIME, HEADER WITH ADDRESS -->
            </tr>
        </thead>
    </table>
    <br>
    <!-- REPORT HEADER -->
    <h2>ALL APPOINTMENT SCHEDULES REPORT <hr></h2>

<!-- END OF COPY FOR LETTERHEAD -->
    <table style="border: 1px transparent;">
        <tbody>
            <tr>
                <td style="
                text-align: left;
                font-size: 12px;
                height: 80px;">
                    {% if fromdate == '2000-01-01' %}
                        <b>Reports from:</b>&nbsp;&nbsp;{{ earlydate.apptDate|date:'Y-m-d' }}&nbsp;&nbsp;<b>-</b>&nbsp;&nbsp;{{ latedate.apptDate|date:'Y-m-d' }}<br>
                    {% else %}
                        <b>Reports from:</b>&nbsp;&nbsp;{{ fromdate }}&nbsp;&nbsp;<b>-</b>&nbsp;&nbsp;{{ todate }}<br>
                    {% endif %}
                    
                    <!-- GENERATED BY -->
                    <b>Generated by:</b>&nbsp;&nbsp;
                    {% for users in user %}
                        {{ users.first_name }}
                        {{ users.last_name }}
                        ({{ users.admin.stafftype }})
                    {% endfor %}
                </td>
                <!-- DATE AND TIME GENERATED -->
                <td style="
                text-align: left;
                font-size: 12px;
                height: 80px;">
                    <b>Date Generated:</b>&nbsp;&nbsp;{{ current_datetime|date:'F m, Y | l' }}
                    <br>
                    <b>Time Generated:</b>&nbsp;&nbsp;{{ current_datetime|time:'f:s A' }}
                    <br>
                </td>
            </tr>
        </tbody>
    </table>
    <!-- END OF REPORT HEADER -->

    <br>
    
    <table>
        <thead>
            <tr>
                <td>No. of Online Customers</td>
                <td>No. of Walkin Customers</td>
                <td>No. of Pending Appointments</td>
                <td>No. of Approved Appointments</td>
                <td>No. of Completed Appointments</td>
                <td>No. of Cancelled Appointments</td>
                <td>Total No. of Appointments</td>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>{{ online_count }}</td>
                <td>{{ walkin_count }}</td>
                <td>{{ pending_count }}</td>
                <td>{{ approve_count }}</td>
                <td>{{ complete_count }}</td>
                <td>{{ cancelled_count }}</td>
                <td>{{ appointment_count }}</td>
            </tr>
        </tbody>
    </table>
    <br>
    <table class="products-table">
        <thead class="products-thead">
            <tr>
                <!-- TABLE HEADER -->
                <th scope="col">Date</th>
                <th scope="col">Time Start</th>
                <th scope="col">Type</th>
                <th scope="col">Status</th>
                <th scope="col">Customer Name</th>
                <th scope="col">First Stylist</th>
                <th scope="col">Second Stylist</th>
                <th scope="col">Stylist</th>
                <th scope="col">Services</th>
            </tr>
        </thead>

        <tbody class="products-tbody">
            {% for appointment in appointments %}
                {% comment %} {% if orderpickup.order.complete == True %} {% endcomment %}
                <tr>
                    <!-- TABLE BODY -->
                    <td>{{appointment.apptDate|date:'F d, Y'}}</td>
                    <td>{{appointment.appt_timeStart|time:'h:i A'}}</td>
                    <td>{{appointment.apptType}}</td>
                    <td>{{appointment.appointmentStatus}}</td>
                    <td data-label="Customer">
                        {% if appointment.apptType == 'Online' %}
                            <p>{{ appointment.customer.customer.first_name }} {{ appointment.customer.customer.last_name }} </p>
                        {% else %}
                            <p>{{ appointment.customer_fname }} {{ appointment.customer_lname }} </p>
                        {% endif %}
                    </td>
                    <td>{{appointment.firstStylist}}</td>
                    <td>{{appointment.secondStylist}}</td>
                    <td>
                        {% if appointment.appointmentStatus == 'Successful'%}
                            {{ appointment.joborderform.finalStylist}}
                        {% else %}
                            <i class="fas fa-ban"></i>
                        {% endif %}
                    </td>
                    <td>         
                        {% for key in appointment.services %}
                            {{ key }}{% if not forloop.last %}{% endif %}
                        {% endfor %}     
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
    <br>
    
    <!-- <table style="border: 1px solid #092147;background-color: #092147; color: white;">
        <thead>
            <tr>
                <td style="
                font-size: 12px;
                height: 20px;">                
                    DAVID'S SALON SM GRAND CENTRAL BRANCH | &#169; SalOnTheGo 2022
                </td>
            </tr>
        </thead>
    </table> -->
</div>

</body>
</html>
