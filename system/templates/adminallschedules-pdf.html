{% load static %}
<html>
<head>
    <title>ALL APPOINTMENT SCHEDULES REPORT</title>
    <link href='http://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
</head>
<body>
    <style>       
        table{
            border: 1px solid black;
        }

        th{
            font-weight: 700;
            font-size: 13px;
            height: 45px;   
            background-color:  #092147;
            padding-top: 5px;
            color: white;
        }

        td{
            text-align: center;   
            height: 55px;   
            font-size: 12px; 
            padding-top: 5px;
            text-decoration:none;
        }

        h1{
            font-size: 20px;
        }

        ul{
            list-style:none;
        }

    </style>

<div class="main">
    <u><b>DATE:</b> {{ current_datetime|date:'F m, Y | l' }}</i></u><br>
    <u><b>TIME:</b> {{ current_datetime|time:'f:s A' }}</i></u><br>
    
    <br>
    <center>
        <h1>ALL APPOINTMENT SCHEDULES REPORT</h1>
        DATE START: <i>{{ fromdate }}</i>
        DATE END: <i>{{ todate }}</i> 
    </center> 
    <table>
        <thead>
            <tr>
                <td>No. of Online Customers</td>
                <td>No. of Walkin Customers</td>
                <td>No. of Pending Appointments</td>
                <td>No. of Approved Appointments</td>
                <td>No. of Completed Appointments</td>
                <td>No. of Cancelled Appointments</td>
                <td>Total No. of Appointments</td>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>{{ online_count }}</td>
                <td>{{ walkin_count }}</td>
                <td>{{ pending_count }}</td>
                <td>{{ approve_count }}</td>
                <td>{{ complete_count }}</td>
                <td>{{ cancelled_count }}</td>
                <td>{{ appointment_count }}</td>
            </tr>
        </tbody>
    </table>
    <br>
    <table class="products-table">
        <thead class="products-thead">
            <tr>
                <!-- TABLE HEADER -->
                <th scope="col">Date</th>
                <th scope="col">Time Start</th>
                <th scope="col">Type</th>
                <th scope="col">Status</th>
                <th scope="col">Customer Name</th>
                <th scope="col">First Stylist</th>
                <th scope="col">Second Stylist</th>
                <th scope="col">Stylist</th>
                <th scope="col">Services</th>
            </tr>
        </thead>

        <tbody class="products-tbody">
            {% for appointment in appointments %}
                {% comment %} {% if orderpickup.order.complete == True %} {% endcomment %}
                <tr>
                    <!-- TABLE BODY -->
                    <td>{{appointment.apptDate|date:'F d, Y'}}</td>
                    <td>{{appointment.appt_timeStart|time:'h:i A'}}</td>
                    <td>{{appointment.apptType}}</td>
                    <td>{{appointment.appointmentStatus}}</td>
                    <td data-label="Customer">
                        {% if appointment.apptType == 'Online' %}
                            <p>{{ appointment.customer.customer.first_name }} {{ appointment.customer.customer.last_name }} </p>
                        {% else %}
                            <p>{{ appointment.customer_fname }} {{ appointment.customer_lname }} </p>
                        {% endif %}
                    </td>
                    <td>{{appointment.firstStylist}}</td>
                    <td>{{appointment.secondStylist}}</td>
                    <td>
                        {% if appointment.appointmentStatus == 'Successful'%}
                            {{ appointment.joborderform.finalStylist}}
                        {% else %}
                            <i class="fas fa-ban"></i>
                        {% endif %}
                    </td>
                    <td>         
                        {% for key in appointment.services %}
                            {{ key }}{% if not forloop.last %}{% endif %}
                        {% endfor %}     
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

</body>
</html>
